# Set the registry key for TCP/IP to Enabled (value 1)
Set-ItemProperty -Path "HKLM:\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQLServer\SuperSocketNetLib\Tcp" -Name "Enabled" -Value 1

**********************************************************************************************************************************************
# Enable TCP/IP for IPAll and IP1
$tcpPaths = @(
  "HKLM:\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQLServer\SuperSocketNetLib\Tcp\IPAll",
  "HKLM:\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQLServer\SuperSocketNetLib\Tcp\IP1",
  "HKLM:\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQLServer\SuperSocketNetLib\Tcp\IP2"
)

foreach ($path in $tcpPaths) {
    Set-ItemProperty -Path $path -Name "Enabled" -Value 1
    Set-ItemProperty -Path $path -Name "Active" -Value 1
}

********************************************************************************************************************************************
# Restart SQL Server (default instance)
Restart-Service -Name 'MSSQLSERVER'




:: Enable TCP/IP globally
reg add "HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQLServer\SuperSocketNetLib\Tcp" /v Enabled /t REG_DWORD /d 1 /f

:: Enable TCP/IP for IPAll and assign port 1433
reg add "HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQLServer\SuperSocketNetLib\Tcp\IPAll" /v TcpPort /t REG_SZ /d 1433 /f
reg add "HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQLServer\SuperSocketNetLib\Tcp\IPAll" /v Enabled /t REG_DWORD /d 1 /f
reg add "HKLM\SOFTWARE\Microsoft\Microsoft SQL Server\MSSQLServer\SuperSocketNetLib\Tcp\IPAll" /v Active /t REG_DWORD /d 1 /f
